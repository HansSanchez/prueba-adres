<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link
      rel="shortcut icon"
      href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png"
    />

    <meta name="theme-color" content="#000000" />

    <title>Prueba técnica Ingeniero de Software - Full stack</title>

    {% load django_bootstrap5 %} {% bootstrap_css %} {% load widget_tweaks %}
    {%load static %}

    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'css/styles.css' %}"
    />
  </head>

  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-adres">
      <div class="container">
            <a class="navbar-brand" href="https://www.adres.gov.co/">
              <img src="https://www.adres.gov.co/PublishingImages/Header%20Logos/logo-adres.svg" class="img-fluid"
              width="70%">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
      </div>
    </nav>
    </header>

    <main role="main">
      <div class="container text-center mt-5">
        <div class="row mb-4">
          <div class="col-md-12">
            <h1 style="font-size: 28px">
              Prueba técnica Ingeniero de Software - Full stack
            </h1>
          </div>
        </div>

        <div class="row mb-5">
          <div class="col-md-12">
            <nav aria-label="breadcrumb mb-3">
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a href="./">Adquisiciones</a>
                </li>
                <li class="breadcrumb-item active">Crear</li>
                <li class="breadcrumb-item active" aria-current="page">
                  {{object.id}}
                </li>
              </ol>
            </nav>

            <div class="formulario" align="left">
              <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 mb-2">
                    <div class="form-group">
                      <label for="budget" class="txt_negrita">
                        Presupuesto
                      </label>
                      <input
                        type="number"
                        name="budget"
                        value="{{ object.budget }}"
                        min="1"
                        class="form-control"
                        placeholder="Monto asigado Ejm. $10.000 millones"
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 mb-2">
                    <div class="form-group">
                      <label for="administrative_unit" class="txt_negrita">
                        Unidad
                      </label>
                      <input
                        type="text"
                        name="administrative_unit"
                        value="{{object.administrative_unit}}"
                        class="form-control"
                        placeholder="Administrativa responsable. Ejm. Dirección de Medicamentos y Tecnologías en Salud"
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-2">
                    <div class="form-group">
                      <label
                        for="type_of_goods_or_services"
                        class="txt_negrita"
                      >
                        Tipo de Bien o Servicio
                      </label>
                      <input
                        type="text"
                        name="type_of_goods_or_services"
                        value="{{object.type_of_goods_or_services}}"
                        class="form-control"
                        placeholder="Descripción. Ejm. Medicamentos"
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 mb-2">
                    <div class="form-group">
                      <label for="quantity" class="txt_negrita">
                        Cantidad
                      </label>
                      <input
                        type="number"
                        name="quantity"
                        min="1"
                        value="{{object.quantity}}"
                        class="form-control input"
                        placeholder="Número de unidades. Ejm. 10.000"
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 mb-2">
                    <div class="form-group">
                      <label for="unit_value" class="txt_negrita">
                        Valor Unitario
                      </label>
                      <input
                        type="number"
                        name="unit_value"
                        min="1"
                        value="{{object.unit_value}}"
                        class="form-control input"
                        placeholder="Costo por unidad. Ejm. $1.000"
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 mb-2">
                    <div class="form-group">
                      <label for="total_value" class="txt_negrita">
                        Valor Total
                      </label>
                      <input
                        type="text"
                        name="total_value"
                        min="1"
                        value="{{object.total_value}}"
                        class="form-control total"
                        placeholder="Costo total. Ejm. $10.000.000"
                        style="background: #e7e7e7"
                        readonly
                      />
                    </div>
                  </div>
                  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 mb-2">
                    <div class="form-group">
                      <label for="acquisition_date" class="txt_negrita">
                        Fecha de Adquisición
                      </label>
                      <input
                        type="text"
                        name="acquisition_date"
                        id="acquisition_date"
                        value="{{object.acquisition_date}}"
                        placeholder="Fecha de Adquisición. Ejm. 20 de julio de 2023"
                        class="form-control"
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 mb-2">
                    <div class="form-group">
                      <label for="supplier" class="txt_negrita">
                        Proveedor
                      </label>
                      <input
                        type="text"
                        name="supplier"
                        value="{{object.supplier}}"
                        class="form-control"
                        placeholder="Entidad proveedora. Ejm. Laboratorios Bayer S.A."
                        required
                      />
                    </div>
                  </div>
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-2">
                    <div class="form-group">
                      <label for="documentation" class="txt_negrita">
                        Documentación
                      </label>
                      <input
                        type="text"
                        name="documentation"
                        value="{{object.documentation}}"
                        class="form-control"
                        placeholder="Detalles como órdenes de compra, facturas, etc. Ejm. Orden de compra No. 2023-07-20-001, factura No. 2023-07-20-001"
                        required
                      />
                    </div>
                  </div>
                  <input
                        type="hidden"
                        name="disabled_at"
                        value="{{object.disabled_at}}"
                        class="form-control"
                  />
                  <div class="col-lg-12 col-md-12 col-sm-4 col-xs-4 mb-4"></div>
                  <hr />
                  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <button type="submit" class="btn btn-warning mt-3 w-100">
                      <i class="fa-solid fa-pencil"></i> <b>Actualizar</b>
                    </button>
                  </div>
                  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <a
                      href="../"
                      type="submit"
                      class="btn btn-danger mt-3 w-100"
                    >
                      <i class="fa-solid fa-xmark"></i> <b>Cancelar</b>
                    </a>
                  </div>
                </div>
                {% comment %}
                <div class="form-group">
                  <label for="img" class="txt_negrita">Imagen</label>
                  {{ form.img|add_class:"form-control mb-3" }}
                  <p class="txt_negrita">Imagen Actual:</p>
                  <img
                    src="{% static 'uploads/'%}{{object.img}}"
                    class="img-fluid"
                    alt="{{object.nombre}}"
                  />
                </div>
                {% endcomment %}
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="text-muted mt-3 mb-3">
      <div align="center">Desarrollado por Hans Yadiel Sánchez Mora</div>
    </footer>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script
      src="https://kit.fontawesome.com/c6ef26fdf4.js"
      crossorigin="anonymous"
    ></script>

    <script type="text/javascript">
      window.onload = function () {
        let inputs = document.querySelectorAll(".input");
        inputs.forEach(function (e) {
          // Solo es necesario un evento, no necesitas otros
          e.addEventListener("input", multiplica);
        });
      };
      function multiplica() {
        // inputs[0] es precio, primera posición
        // inputs[1] es cantidad
        let inputs = document.querySelectorAll(".input");

        //Eliminar puntos, remplazar coma por punto y asegurar que es un número
        // Si algo falla, el valor será cero
        let precio =
          parseFloat(inputs[0].value.replaceAll(".", "").replace(",", ".")) ||
          0;

        // El input de cantidad es numérico, no es necesario hacer remplazos
        let cantidad = parseFloat(inputs[1].value) || 0;

        // Calcuar total de esta fila
        let total = (precio * cantidad).toFixed(2);
        document.querySelector(".total").value = number_format(total, 2); // Usar la función para formatear
      }

      function number_format(amonth, decimals) {
        amonth += ""; // por si pasan un numero en vez de un string
        amonth = parseFloat(amonth.replace(/[^0-9\.]/g, "")); // elimino cualquier cosa que no sea numero o punto
        decimals = decimals || 0; // por si la variable no fue fue pasada
        // si no es un numero o es igual a cero retorno el mismo cero
        if (isNaN(amonth) || amonth === 0)
          return parseFloat(0).toFixed(decimals);
        // si es mayor o menor que cero retorno el valor formateado como numero
        amonth = "" + amonth.toFixed(decimals);
        var amonth_parts = amonth.split("."),
          regexp = /(\d+)(\d{3})/;
        while (regexp.test(amonth_parts[0]))
          while (regexp.test(amonth_parts[0]))
            amonth_parts[0] = amonth_parts[0].replace(
              regexp,
              "$1" + "," + "$2"
            );
        return amonth_parts.join(".");
      }

      $(document).ready(function () {
        $("#acquisition_date").datepicker({
          dateFormat: "dd/mm/yy",
        });
      });
    </script>
  </body>
</html>
